# encoding: UTF-8
require 'addressable/uri'
require 'open-uri'
require 'nokogiri'

# files = ["A_chilly_Peace_infests_the_Grass.txt", "A_Murmur_in_the_Trees_—_to_note.txt", "A_Night_—_there_lay_the_Days_between.txt", "A_poor_—_torn_heart_—_a_tattered_heart.txt", "A_precious_—_mouldering_pleasure_—_'tis.txt", "A_Secret_told.txt", "A_shady_friend_—_for_Torrid_days.txt", "A_slash_of_Blue.txt", "A_solemn_thing_—_it_was_—_I_said.txt", "A_throe_upon_the_features.txt", "A_Toad,_can_die_of_Light_—.txt", "A_Visitor_in_Marl.txt", "A_Weight_with_Needles_on_the_pounds.txt", "A_Wife_—_at_daybreak_I_shall_be.txt", "A_Wounded_Deer_—_leaps_highest.txt", "After_great_pain,_a_formal_feeling_comes.txt", "Alone,_I_cannot_be.txt", "Alter!_When_the_Hills_do_—.txt", "Although_I_put_away_his_life.txt", "An_altered_look_about_the_hills.txt", "And_with_what_body_do_they_come?_—.txt", "Answer_July.txt", "Arcturus_is_his_other_name.txt", "As_far_from_pity,_as_complaint.txt", "As_if_I_asked_a_common_Alms.txt", "Awake_ye_muses_nine.txt", "Baffled_for_just_a_day_or_two.txt", "Before_the_ice_is_in_the_pools.txt", "Bound_—_a_trouble.txt", "By_a_flower_—_By_a_letter.txt", "Come_slowly_—_Eden!.txt", "Could_I_—_then_—_shut_the_door.txt", "Could_live_—_did_live.txt", "Could_—_I_do_more_—_for_Thee.txt", "Delayed_till_she_had_ceased_to_know.txt", "Delight_is_as_the_flight.txt", "Did_Our_Best_Moment_last.txt", "Distrustful_of_the_Gentian.txt", "Doom_is_the_House_without_the_Door.txt", "Dust_is_the_only_Secret.txt", "Except_the_Heaven_had_come_so_near.txt", "Exhilaration_—_is_within.txt", "Faith_is_a_fine_invention.txt", "Faithful_to_the_end_Amended.txt", "For_every_Bird_a_Nest.txt", "For_largest_Woman's_Hearth_I_knew.txt", "For_this_—_accepted_Breath.txt", "Forever_at_His_side_to_walk.txt", "Frequently_the_wood_are_pink.txt", "Funny_—_to_be_a_Century.txt", "Garland_for_Queens,_may_be.txt", "Give_little_Anguish.txt", "Go_tell_it_—_What_a_Message_—.txt", "Go_travelling_with_us!.txt", "God_is_a_distant_—_stately_Lover.txt", "God_made_a_little_Gentian.txt", "God_permits_industrious_Angels.txt", "Good_Morning_—_Midnight.txt", "He_forgot_—_and_I_—_remembered.txt", "He_strained_my_faith.txt", "He_was_weak,_and_I_was_strong_—_then.txt", "Heaven_has_different_Signs_—_to_me_—.txt", "Heaven_—_is_what_I_cannot_reach!.txt", "Heavenly_Father_—_take_to_thee.txt", "Her_—_\"last_Poems\".txt", "Houses_—_so_the_Wise_Men_tell_me.txt", "How_many_Flowers_fail_in_Wood.txt", "How_many_times_these_low_feet_staggered.txt", "How_sick_—_to_wait_—_in_any_place_—_but_thine.txt", "I'll_clutch_—_and_clutch.txt", "I'll_tell_you_how_the_Sun_rose.txt", "I'm_\"wife\"_—_I've_finished_that.txt", "I've_known_a_Heaven,_like_a_Tent.txt", "I've_nothing_else_—_to_bring,_You_know.txt", "I_am_alive_—_I_guess.txt", "I_am_ashamed_—_I_hide.txt", "I_breathed_enough_to_take_the_Trick.txt", "I_Came_to_buy_a_smile_—_today.txt", "I_can't_tell_you_—_but_you_feel_it.txt", "I_can_wade_Grief.txt", "I_cannot_dance_upon_my_Toes.txt", "I_cautious,_scanned_my_little_life.txt", "I_envy_Seas,_whereon_He_rides.txt", "I_gained_it_so.txt", "I_got_so_I_could_take_his_name.txt", "I_had_a_guinea_golden.txt", "I_had_no_time_to_Hate.txt", "I_had_not_minded_—_Walls.txt", "I_had_some_things_that_I_called_mine.txt", "I_had_the_Glory_—_that_will_do.txt", "I_have_a_King,_who_does_not_speak.txt", "I_have_never_seen_\"Volcanoes\".txt", "I_haven't_told_my_garden_yet.txt", "I_held_a_Jewel_in_my_fingers.txt", "I_know_where_Wells_grow_—_Droughtless_Wells.txt", "I_live_with_Him_—_I_see_His_face.txt", "I_lost_a_World_—_the_other_day!.txt", "I_meant_to_have_but_modest_needs.txt", "I_never_felt_at_Home_—_Below.txt", "I_pay_—_in_Satin_Cash.txt", "I_read_my_sentence_—_steadily.txt", "I_reason,_Earth_is_short.txt", "I_robbed_the_Woods.txt", "I_saw_no_Way_—_The_Heavens_were_stitched.txt", "I_send_Two_Sunsets.txt", "I_shall_know_why_—_when_Time_is_over.txt", "I_should_have_been_too_glad,_I_see.txt", "I_showed_her_Heights_she_never_saw.txt", "I_stole_them_from_a_Bee.txt", "I_tend_my_flowers_for_thee.txt", "I_think_just_how_my_shape_will_rise.txt", "I_tie_my_Hat_—_I_crease_my_Shawl.txt", "I_want_—_it_pleaded_—_All_its_life_—.txt", "I_was_the_slightest_in_the_House.txt", "I_went_to_Heaven.txt", "I_went_to_thank_Her.txt", "I_would_distil_a_cup.txt", "If_any_sink,_assure_that_this,_now_standing.txt", "If_He_dissolve_—_then.txt", "If_the_foolish,_call_them_\"flowers\".txt", "If_What_we_could_—_were_what_we_would.txt", "If_your_Nerve,_deny_you.txt", "Is_it_dead_—_Find_it.txt", "It's_all_I_have_to_bring_today.txt", "It's_coming_—_the_postponeless_Creature.txt", "It's_like_the_Light.txt", "It's_such_a_little_thing_to_weep.txt", "It's_thoughts_—_and_just_One_Heart.txt", "It_did_not_surprise_me.txt", "It_don't_sound_so_terrible_—_quite_—_as_it_did.txt", "It_feels_a_shame_to_be_Alive.txt", "It_is_easy_to_work_when_the_soul_is_at_play.txt", "It_sifts_from_Leaden_Sieves.txt", "It_struck_me_—_every_Day.txt", "It_was_given_to_me_by_the_Gods.txt", "It_would_never_be_Common_—_more_—_I_said.txt", "Just_so_—_Jesus_—_raps.txt", "Kill_your_Balm_—_and_its_Odors_bless_you.txt", "Least_Rivers_—_docile_to_some_sea.txt", "Lethe_in_my_flower.txt", "Like_eyes_that_looked_on_Wastes.txt", "Love_—_thou_art_high.txt", "Make_me_a_picture_of_the_sun.txt", "Many_a_phrase_has_the_English_language.txt", "Morning_—_is_the_place_for_Dew.txt", "Morning_—_means_\"Milking\"_—_to_the_Farmer.txt", "Morns_like_these_—_we_parted.txt", "Musicians_wrestle_everywhere.txt", "Mute_thy_Coronation.txt", "My_Eye_is_fuller_than_my_vase.txt", "My_friend_must_be_a_Bird.txt", "My_Garden_—_like_the_Beach.txt", "My_nosegays_are_for_Captives.txt", "My_River_runs_to_thee.txt", "Myself_was_formed_—_a_Carpenter.txt", "Nature_is_what_we_see_—.txt", "Nature_—_sometimes_sears_a_Sapling.txt", "No_Man_can_compass_a_Despair.txt", "No_Rack_can_torture_me.txt", "Nobody_knows_this_little_Rose.txt", "Not_in_this_World_to_see_his_face.txt", "Not_probable_—_The_barest_Chance.txt", "Of_all_the_Sounds_despatched_abroad.txt", "Of_Bronze_—_and_Blaze.txt", "Of_Course_—_I_prayed.txt", "Of_Tribulation,_these_are_They.txt", "On_this_long_storm_the_Rainbow_rose.txt", "One_Sister_have_I_in_our_house.txt", "Our_lives_are_Swiss.txt", "Our_share_of_night_to_bear.txt", "Over_and_over,_like_a_Tune.txt", "Over_the_fence.txt", "Perhaps_I_asked_too_large.txt", "Peril_as_a_Possession.txt", "Pigmy_seraphs_—_gone_astray.txt", "Read_—_Sweet_—_how_others_—_strove.txt", "Red_Sea,_indeed!_Talk_not_to_me.txt", "Remember_me_implored_the_Thief!.txt", "Safe_in_their_Alabaster_Chambers.txt", "Savior!_I've_no_one_else_to_tell.txt", "Secrets_is_a_daily_word.txt", "She_dealt_her_pretty_words_like_Blades.txt", "She_slept_beneath_a_tree.txt", "She_sweeps_with_many-colored_Brooms.txt", "Should_you_but_fail_at_—_Sea.txt", "So_well_that_I_can_live_without.txt", "Some_things_that_fly_there_be.txt", "Some_—_Work_for_Immortality.txt", "South_Winds_jostle_them.txt", "Sown_in_dishonor!.txt", "Speech_—_is_a_prank_of_Parliament_—.txt", "Success_is_counted_sweetest.txt", "Sunset_at_Night_—_is_natural.txt", "Sweet_—_safe_—_Houses.txt", "Take_your_Heaven_further_on.txt", "Taken_from_men_—_this_morning.txt", "Teach_Him_—_When_He_makes_the_names.txt", "That_after_Horror_—_that_'twas_us.txt", "The_Angle_of_a_Landscape.txt", "The_Color_of_the_Grave_is_Green.txt", "The_Court_is_far_away.txt", "The_Daisy_follows_soft_the_Sun.txt", "The_Day_came_slow_—_till_Five_o'clock.txt", "The_Drop,_that_wrestles_in_the_Sea.txt", "The_earth_has_many_keys.txt", "The_face_I_carry_with_me_—_last.txt", "The_first_Day's_Night_had_come.txt", "The_Flower_must_not_blame_the_Bee.txt", "The_Gentian_weaves_her_fringes.txt", "The_Grass_so_little_has_to_do.txt", "The_Guest_is_gold_and_crimson.txt", "The_Juggler's_Hat_her_Country_is.txt", "The_Lamp_burns_sure_—_within.txt", "The_lonesome_for_they_know_not_What.txt", "The_Malay_—_took_the_Pearl.txt", "The_Months_have_ends_—_the_Years_—_a_knot.txt", "The_Moon_is_distant_from_the_Sea.txt", "The_Morning_after_Woe.txt", "The_morns_are_meeker_than_they_were.txt", "The_nearest_Dream_recedes_—_unrealized.txt", "The_One_who_could_repeat_the_Summer_day.txt", "The_Red_—_Blaze_—_is_the_Morning.txt", "The_Robin's_my_Criterion_for_Tune.txt", "The_Rose_did_caper_on_her_cheek.txt", "The_Sun_—_just_touched_the_Morning.txt", "The_thought_beneath_so_slight_a_film.txt", "The_Wind_begun_to_rock_the_Grass.txt", "The_Wind_didn't_come_from_the_Orchard_—_today.txt", "The_Wind_—_tapped_like_a_tired_Man.txt", "The_Winters_are_so_short.txt", "The_World_—_stands_—_solemner_—_to_me.txt", "There's_a_certain_Slant_of_light.txt", "There_are_two_Ripenings_—_one_—_of_sight.txt", "There_came_a_Day_at_Summer's_full.txt", "There_is_a_flower_that_Bees_prefer.txt", "There_is_a_morn_by_men_unseen.txt", "They_dropped_like_Flakes.txt", "They_have_not_chosen_me,_he_said.txt", "They_put_Us_far_apart.txt", "This_heart_that_broke_so_long.txt", "This_—_is_the_land_—_the_Sunset_washes.txt", "Tho'_I_get_home_how_late_—_how_late.txt", "Tho'_my_destiny_be_Fustian.txt", "Those_fair_—_fictitious_People.txt", "Through_lane_it_lay_—_through_bramble.txt", "Through_the_Dark_Sod_—_as_Education.txt", "Tis_Opposites_—_entice.txt", "Tis_so_appalling_—_it_exhilarates.txt", "To_die_—_takes_just_a_little_while.txt", "To_earn_it_by_disdaining_it.txt", "To_fight_aloud,_is_very_brave.txt", "To_hang_our_head_—_ostensibly.txt", "To_love_thee_Year_by_Year.txt", "Tomorrow_—_whose_location.txt", "Triumph_—_may_be_of_several_kinds.txt", "Twas_Love_—_not_me.txt", "Twas_the_old_—_road_—_through_pain.txt", "Two_swimmers_wrestled_on_the_spar.txt", "Unto_like_Story_—_Trouble_has_enticed_me.txt", "Unto_Me?_I_do_not_know_you_—.txt", "Up_Life's_Hill_with_my_little_Bundle.txt", "Was_not_was_all_the_Statement..txt", "We_Cover_Thee_—_Sweet_Face.txt", "We_do_not_play_on_Graves.txt", "We_grow_accustomed_to_the_Dark.txt", "We_lose_—_because_we_win.txt", "We_play_at_Paste.txt", "We_pray_—_to_Heaven.txt", "We_should_not_mind_so_small_a_flower.txt", "We_—_Bee_and_I_—_live_by_the_quaffing.txt", "What_I_can_do_—_I_will.txt", "What_is_—_\"Paradise\".txt", "What_shall_I_do_—_it_whimpers_so.txt", "What_Soft_—_Cherubic_Creatures.txt", "When_Night_is_almost_done.txt", "When_we_stand_on_the_tops_of_Things.txt", "Where_bells_no_more_affright_the_morn.txt", "Where_I_have_lost,_I_softer_tread.txt", "Where_Ships_of_Purple_—_gently_toss.txt", "While_Asters.txt", "Why_do_I_love_You,_Sir?.txt", "Why_make_it_doubt_—_it_hurts_it_so.txt", "With_thee,_in_the_Desert.txt", "You'll_know_it_—_as_you_know_'tis_Noon.txt", "You're_right_—_\"the_way_is_narrow\".txt", "You_love_me_—_you_are_sure.txt", "You_love_the_Lord_—_you_cannot_see.txt", "You_see_I_cannot_see_—_your_lifetime.txt"]
Dir.chdir("poems")
empty_files = []
Dir.foreach(".") do |filename|
  empty_files.push(filename) if File.size(filename) == 0
end
puts empty_files

titles = empty_files.collect do |filename|
  filename.split(".").first + "_—"
end

# Obtains the poem
# Nokogiri::HTML(open("http:#{doc.css('.extiw').first.attr('href')}"))
# bee.css(".poem").text
empty_files.zip(titles).each do |file, title|
  url = "http://en.wikisource.org/wiki/#{title}"
  v = Addressable::URI.parse(url)
  normalized_uri = v.normalize
  begin
    lines = Nokogiri::HTML(open(normalized_uri)).css(".poem").text
    File.open(file, 'a') { |f| f.write(lines) }
  rescue OpenURI::HTTPError
  end
end

# 1,494 items